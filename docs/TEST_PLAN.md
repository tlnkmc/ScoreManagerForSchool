# ScoreManagerForSchool 测试清单（QA Checklist）

> 目标：覆盖“所有应测试的操作与功能”，用于功能验证、回归与发布前自检。
>
> 适用版本：请在执行前填入当前构建信息。

- 版本/提交：
- 构建时间：
- 目标平台：Windows / macOS / Linux（优先 Windows，exe 名称需为 scoremgr.exe）
- 执行人：
- 执行日期：

---

## 冒烟用例（P0，先跑）

- [ ] 首次启动进入 OOBE，可设置主密码与密保，导入任意一个有效学生 CSV，点击完成后进入主界面不崩溃。
- [ ] 非首次启动显示登录/解锁，正确密码可进入；错误密码提示不退出。
- [ ] 主界面侧边栏可切换各页面；无未处理异常弹框。
- [ ] 学生列表管理：选择 CSV → 预览 → 保存，数据成功写入，重启后仍在。
- [ ] 班级及方案管理：导入班级、导入方案至少一次成功。
- [ ] “格式说明”按钮在 OOBE/学生列表/方案管理均可打开，内容完整。

---

## OOBE 首次体验与引导

### 基础流程
- [ ] 首次启动自动进入 OOBE，支持最小窗口尺寸与 DPI 缩放。
- [ ] 设备 ID 自动生成并用于绑定（如有显示/日志可验证）。
- [ ] 主密码输入 + 确认一致校验；不一致时有即时提示且无法继续。
- [ ] 密码显示/隐藏“👁”按钮可切换，状态正确；复制/粘贴正常。
- [ ] 安全问题（secqa.json）：
  - [ ] 要求设置的问题数量与答案长度规则生效。
  - [ ] 禁止空答案或仅空白字符。
- [ ] 导入区存在学生/班级/方案三行，每行均有：浏览、（必要时）预览/导入、“格式说明”。
- [ ] 文件选择器仅允许 csv/xls/xlsx；取消选择不报错。
- [ ] 选择文件后输入框自动填充绝对路径；临时文件复制（如沙盒路径）后仍可用。
- [ ] 点击完成：
  - [ ] 正常进入主窗口（先显示主窗→设为 MainWindow→关闭 OOBE，不崩溃）。
  - [ ] 生成/更新存储文件：Database1.json（加密），students.json，classes.json，schemes.json，appconfig.json，secqa.json。
  - [ ] appconfig.json 标记“已完成 OOBE”。

### 异常与边界
- [ ] 密码为空/过短/仅空格不可继续。
- [ ] 安全问题未填写/超长/包含非法字符时提示。
- [ ] 导入空文件、格式错误、扩展名不匹配、损坏 Excel、无权限路径，均提示并允许重试。
- [ ] 导入完成但仍可跳过其他导入项，不会阻塞。

---

## 登录/解锁与找回

- [ ] 存在存储时启动进入登录；输入正确密码解锁。
- [ ] 错误密码：提示清晰，支持连续错误尝试，必要时节流/冷却提示。
- [ ] 忘记密码：
  - [ ] 进入密保问题回答页面；答案正确允许重设/解锁。
  - [ ] 答案错误提示并可重试；错误多次后节流。
- [ ] 剪贴板/输入法对密码框无异常；中文输入法不影响。
- [ ] 设备变更（如设备 ID 不同）时的处理/提示（如适用）。

---

## 主导航与页面切换

- [ ] 侧边栏展示：信息录入、积分统计、学生列表管理、班级评价、班级及评价方案管理、设置、关于。
- [ ] 默认选中页正确（如信息录入/上次状态）。
- [ ] 切换各页面不抛异常；切回页面状态保持（输入/滚动位置/筛选）。

---

## 学生列表管理（导入/预览/保存）

### 工具栏与交互
- [ ] 工具栏按钮顺序固定为“浏览、预览、保存”。
- [ ] 路径框随浏览选择自动填充绝对路径。
- [ ] 浏览按钮仅允许 csv/xls/xlsx。
- [ ] “格式说明”按钮弹窗可滚动、可复制文本；内容与实际解析一致。
- [ ] 各按钮在无文件/无变更/进行中时的可用性状态正确。

### 预览
- [ ] 含标题/不含标题切换对数据行数生效。
- [ ] 编码：UTF-8（含/不含 BOM）、GBK，均能正确解析。
- [ ] CSV 引号/逗号/换行在字段中的处理正确（如使用 CsvImporter 当前策略）。
- [ ] Excel：xls/xlsx 多表格，默认取首表或按实现策略提示；空表提示。
- [ ] 大文件（>10 万行）预览不致 UI 卡死（可抽样显示/提示）。

### 保存
- [ ] 正确写入 students.json；重复学号/ID 的处理策略（覆盖/去重/拒绝）符合设计并提示。
- [ ] 保存失败（I/O、权限、磁盘满）回滚且有提示。
- [ ] 保存后预览区/按钮状态重置合理。

### 批量变更班级
- [ ] 支持通过文件批量调整学生班级；
- [ ] 输入格式校验，重复/不存在学生的提示；
- [ ] 写入 classes/students 关系后数据一致性验证。

---

## 信息录入

- [ ] 粘贴多行；调用“完成/下一条”会删除当前行并自动选中下一行。
- [ ] PasteText 文本与内部行列表同步，不出现“已处理行仍存在”的情况。
- [ ] 班级/学生/原因/分值选择校验：必填、范围、格式。
- [ ] 执行成功记录到 evaluations.json（或对应存储）。
- [ ] 重复快速操作不会产生重复提交（如按钮防抖）。

---

## 积分统计

- [ ] 按学生、班级、时间区间与原因进行聚合统计。
- [ ] 小数/整数显示精度一致；合计/平均准确。
- [ ] 空数据提示；大数据下交互保持流畅或有进度提示。
- [ ] 导出（如支持）：格式、编码、文件覆盖提示。

---

## 班级评价

- [ ] 选择评价方案并对班级打分；校验每项的范围与权重。
- [ ] 保存评价记录；重复评价同一时间段的策略（覆盖/新增）。
- [ ] 历史记录浏览/撤回（如支持）。

---

## 班级及评价方案管理

- [ ] 班级：新增/编辑/删除；重名/编号重复校验；与学生数据一致性。
- [ ] 方案：新增/编辑/删除；项数上限、权重和校验（合计=100% 等）。
- [ ] 导入班级/方案：
  - [ ] 浏览过滤、路径自动填充；
  - [ ] 预览（如实现）；格式错误/空文件提示；
  - [ ] “格式说明”按钮与实际解析一致；
  - [ ] 保存并落盘到 classes.json / schemes.json。

---

## 设置

- [ ] 自动启动（仅 Windows）：开启写入注册表；关闭移除；非 Windows 不显示此项或禁用。
- [ ] 更新检查：网络可用/无可用更新/有可用更新/请求失败；提示文案清晰。
- [ ] 主题/语言（如有）：切换即时生效或明确提示需重启。
- [ ] 数据文件位置显示/变更（如有）。

---

## 关于

- [ ] 显示应用名称、版本、版权、许可证；链接可点击并在默认浏览器打开。

---

## 文件导入/导出通用覆盖

- [ ] 支持扩展名：csv/xls/xlsx，其他扩展名拒绝并提示。
- [ ] CSV：
  - [ ] 逗号分隔；字段中包含逗号/引号/换行；双引号转义。
  - [ ] 空行、仅空格行、列数不一致；
  - [ ] 编码：UTF-8（BOM/无 BOM）、GBK。
- [ ] Excel：
  - [ ] xls 与 xlsx；多工作表；空表；合并单元格（按实现策略）。
  - [ ] 损坏文件与密码保护的文件。
- [ ] I/O：
  - [ ] 无权限、只读、路径过长、网络盘断开、磁盘空间不足。
  - [ ] 临时文件复制（沙盒）；绝对路径填充正确。

---

## “格式说明”按钮一致性

- [ ] OOBE、学生列表、方案管理的“格式说明”内容一致（学生/班级/方案各自一致）。
- [ ] 文案包含：必填列、示例、是否需要标题行、编码建议、常见错误。
- [ ] 弹窗可复制文本、可滚动、Esc/关闭按钮可用。

---

## 存储、安全与兼容

- [ ] Database1.json 为加密内容；正确密码可解密，错误密码不可解密。
- [ ] secqa.json 正确写入密保问题与答案（加密/明文按设计）。
- [ ] appconfig.json 标记首次引导完成；变更项持久化。
- [ ] 历史兼容：如存在 pwhint1.ini 的旧版本，升级路径与迁移策略（如适用）。
- [ ] 设备绑定：设备 ID 变化时行为与提示（如适用）。

---

## 稳定性与异常处理

- [ ] 全局未处理异常：弹出对话框 + 写入 smfs_fatal.log；日志包含堆栈与时间。
- [ ] 常见错误路径均有用户可读提示：导入失败、格式错误、网络不可用、权限不足。
- [ ] 多次重复操作不会造成崩溃或数据损坏（幂等/防抖）。

---

## 性能与大数据

- [ ] 启动时间：首次 < Xs，二次 < Ys（自定阈值）。
- [ ] 导入 1 万/5 万/50 万行：
  - [ ] 用时、内存峰值记录；
  - [ ] UI 响应仍可交互或提供进度提示。
- [ ] 统计视图对大量数据聚合的耗时与内存。

---

## 跨平台与可用性

- [ ] Windows：可执行名称为 scoremgr.exe；图标显示；高 DPI 正确缩放。
- [ ] macOS/Linux（如支持）：文件选择器行为、路径展示、字体渲染、主题一致。
- [ ] 键盘可达性：Tab 顺序合理；Enter/Esc/快捷键；焦点可见。
- [ ] 高对比度/深浅色主题切换无错位。

---

## 日志与诊断（如有）

- [ ] 日志开关：默认级别；错误详细；敏感信息不泄露。
- [ ] 日志文件大小/轮转策略（如有）。

---

## 回归套件（每次合并/发版最少执行）

- [ ] 冒烟用例全量。
- [ ] OOBE 完整流程（新环境）。
- [ ] 学生导入预览+保存。
- [ ] 班级/方案导入至少各一次。
- [ ] 密保找回一次完整流程。
- [ ] 全局异常注入一次（模拟）。

---

## 测试数据与准备

- [ ] 使用仓库 testdata/ 下的 classes.csv / schemes.csv / students.csv 验证基础导入。
- [ ] 自制边界数据（含引号、逗号、换行、超长字段、重复、空列、极大量）。
- [ ] 权限/路径类场景需准备只读文件、长路径与网络盘路径。

---

## 用例模板（复制后逐条填写）

```
用例编号：SMFS-XXX
标题：
前置条件：
步骤：
1)
2)
3)
期望结果：
实际结果：
结论：通过 / 失败
备注/附件：截屏、日志路径
```

---

## 变更记录

- 2025-08-24：初版生成，覆盖功能与异常路径，新增“格式说明”一致性检查。
