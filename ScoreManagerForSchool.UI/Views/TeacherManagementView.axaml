<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:ScoreManagerForSchool.UI.ViewModels"
             x:Class="ScoreManagerForSchool.UI.Views.TeacherManagementView"
             x:DataType="vm:TeacherManagementViewModel">
  <Grid RowDefinitions="Auto,Auto,Auto,*,Auto" Margin="12" RowSpacing="8">
    
    <!-- æ ‡é¢˜ -->
    <TextBlock Text="æ•™å¸ˆå’Œç­çº§ç®¡ç†" FontSize="20" FontWeight="Bold"/>
    
    <!-- å·¥å…·æ  -->
    <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="8">
      <Button Content="å¯¼å…¥æ•™å¸ˆ" Command="{Binding ImportTeachersCommand}"/>
      <Button Content="å¯¼å‡ºæ¨¡æ¿" Command="{Binding ExportTemplateCommand}"/>
  <Button Content="åˆ·æ–°" Command="{Binding RefreshCommand}"/>
  <Button Content="ç®¡ç†ç§‘ç›®ç»„" Click="OnManageSubjectGroups"/>
      <Button Content="æ–°å¢žæ•™å¸ˆ" Click="OnAddTeacherClick"/>
      <Separator/>
      <TextBox Width="200" Watermark="æœç´¢æ•™å¸ˆï¼ˆæ”¯æŒæ‹¼éŸ³ï¼‰" Text="{Binding SearchQuery, Mode=TwoWay}"/>
    </StackPanel>
    
    <!-- å¯¼å…¥æ ¼å¼è¯´æ˜Ž -->
    <Expander Grid.Row="2" Header="ðŸ“‹ å¯¼å…¥æ ¼å¼è¯´æ˜Ž" IsExpanded="False">
      <Border Background="#F8F9FA" Padding="12" CornerRadius="6" Margin="0,4">
        <StackPanel Spacing="8">
          <TextBlock Text="CSVæ–‡ä»¶æ ¼å¼è¦æ±‚ï¼š" FontWeight="SemiBold" Foreground="#2C3E50"/>
          
          <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto" RowSpacing="4" ColumnSpacing="8">
            <TextBlock Grid.Row="0" Grid.Column="0" Text="â€¢ åˆ—åï¼š" FontWeight="Medium" Foreground="#34495E"/>
            <TextBlock Grid.Row="0" Grid.Column="1" Text="æ•™å¸ˆå·¥å·, æ•™å¸ˆå§“å, ä»»æ•™ç§‘ç›®, ç§‘ç›®ç»„, ä»»æ•™ç­çº§" Foreground="#7F8C8D" FontFamily="Consolas"/>
            
            <TextBlock Grid.Row="1" Grid.Column="0" Text="â€¢ ç¼–ç ï¼š" FontWeight="Medium" Foreground="#34495E"/>
            <TextBlock Grid.Row="1" Grid.Column="1" Text="UTF-8 æˆ– GB2312 ç¼–ç " Foreground="#7F8C8D"/>
            
            <TextBlock Grid.Row="2" Grid.Column="0" Text="â€¢ ç­çº§ï¼š" FontWeight="Medium" Foreground="#34495E"/>
            <TextBlock Grid.Row="2" Grid.Column="1" Text="å¤šä¸ªç­çº§ç”¨åˆ†å·(;)åˆ†éš”ï¼Œå¦‚ï¼šé«˜ä¸€1ç­;é«˜ä¸€2ç­" Foreground="#7F8C8D"/>
            
            <TextBlock Grid.Row="3" Grid.Column="0" Text="â€¢ ç¤ºä¾‹ï¼š" FontWeight="Medium" Foreground="#34495E"/>
            <Border Grid.Row="3" Grid.Column="1" Background="#FFFFFF" Padding="4" 
                    BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="3">
              <TextBlock Text="T001, å¼ è€å¸ˆ, æ•°å­¦, æ•°å­¦ç»„, é«˜ä¸€1ç­;é«˜ä¸€2ç­" 
                         Foreground="#7F8C8D" FontFamily="Consolas"/>
            </Border>
            
            <TextBlock Grid.Row="4" Grid.Column="0" Text="â€¢ æ³¨æ„ï¼š" FontWeight="Medium" Foreground="#E74C3C"/>
            <TextBlock Grid.Row="4" Grid.Column="1" Text="å·¥å·ä¸èƒ½é‡å¤ï¼Œå§“åæ”¯æŒè‡ªåŠ¨æ‹¼éŸ³ç´¢å¼•ç”Ÿæˆ" Foreground="#C0392B"/>
            
            <TextBlock Grid.Row="5" Grid.Column="0" Text="â€¢ æ¨¡æ¿ï¼š" FontWeight="Medium" Foreground="#27AE60"/>
            <TextBlock Grid.Row="5" Grid.Column="1" Text="ç‚¹å‡»'å¯¼å‡ºæ¨¡æ¿'æŒ‰é’®å¯èŽ·å–æ ‡å‡†æ ¼å¼çš„ç¤ºä¾‹æ–‡ä»¶" Foreground="#229954"/>
          </Grid>
          
          <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,8,0,0">
            <Border Background="#E3F2FD" Padding="6,4" CornerRadius="12">
              <TextBlock Text="ðŸ’¡ æç¤º" FontSize="11" Foreground="#1976D2" FontWeight="Medium"/>
            </Border>
            <TextBlock Text="å»ºè®®å…ˆå¯¼å‡ºæ¨¡æ¿ï¼Œåœ¨æ¨¡æ¿åŸºç¡€ä¸Šå¡«å†™æ•™å¸ˆä¿¡æ¯ï¼Œç¡®ä¿æ ¼å¼æ­£ç¡®" 
                       FontSize="11" Foreground="#546E7A"/>
          </StackPanel>
        </StackPanel>
      </Border>
    </Expander>
    
  <!-- ä¸»å†…å®¹åŒºï¼ˆæ•´ä½“å¯æ»šåŠ¨ï¼‰ -->
  <ScrollViewer Grid.Row="3" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
  <Grid RowDefinitions="Auto,Auto,Auto" RowSpacing="16">
      
      <!-- æ•™å¸ˆåˆ—è¡¨ -->
      <Border BorderBrush="#DDD" BorderThickness="1" CornerRadius="6" Padding="12">
        <Grid RowDefinitions="Auto,Auto,*" RowSpacing="8">
          <TextBlock Text="æ•™å¸ˆåˆ—è¡¨" FontWeight="Bold" Margin="0,0,0,4"/>
          
          <!-- è¡¨å¤´ï¼ˆç§»é™¤å·¥å·ï¼Œä»…ç•Œé¢éšè—ï¼Œä¸å½±å“æ•°æ®ï¼‰ -->
          <Border Grid.Row="1" Background="#F5F5F5" Padding="12,8" CornerRadius="4">
            <Grid ColumnDefinitions="120,100,100,*" ColumnSpacing="16">
              <TextBlock Text="å§“å" FontWeight="SemiBold" FontSize="13" Foreground="#555"/>
              <TextBlock Grid.Column="1" Text="ç§‘ç›®" FontWeight="SemiBold" FontSize="13" Foreground="#555"/>
              <TextBlock Grid.Column="2" Text="ç§‘ç›®ç»„" FontWeight="SemiBold" FontSize="13" Foreground="#555"/>
              <TextBlock Grid.Column="3" Text="ä»»æ•™ç­çº§" FontWeight="SemiBold" FontSize="13" Foreground="#555"/>
            </Grid>
          </Border>
          
          <ListBox Grid.Row="2" ItemsSource="{Binding Teachers}" SelectedItem="{Binding SelectedTeacher, Mode=TwoWay}"
                   Background="Transparent" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Auto"
                   ScrollViewer.VerticalScrollBarVisibility="Auto" MaxHeight="480">
            <ListBox.ItemTemplate>
              <DataTemplate>
                <Border BorderBrush="#EEE" BorderThickness="0,0,0,1" Padding="12,8">
                  <Grid ColumnDefinitions="120,100,100,*" ColumnSpacing="16" MinWidth="400">
                    <TextBlock Text="{Binding Name}" FontWeight="SemiBold" FontSize="12"
                               TextTrimming="CharacterEllipsis" ToolTip.Tip="{Binding Name}"
                               VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="1" Text="{Binding Subject}" FontSize="12" 
                               TextTrimming="CharacterEllipsis" ToolTip.Tip="{Binding Subject}"
                               VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="2" Text="{Binding SubjectGroup}" FontSize="12"
                               TextTrimming="CharacterEllipsis" ToolTip.Tip="{Binding SubjectGroup}"
                               VerticalAlignment="Center"/>
                    <TextBlock Grid.Column="3" Text="{Binding ClassesText}" FontSize="11"
                               TextWrapping="Wrap" TextTrimming="CharacterEllipsis" 
                               Foreground="Gray" ToolTip.Tip="{Binding ClassesText}"
                               VerticalAlignment="Center" MaxHeight="50"/>
                  </Grid>
                </Border>
              </DataTemplate>
            </ListBox.ItemTemplate>
          </ListBox>
        </Grid>
      </Border>
      
      <!-- åˆ†éš”çº¿ -->
      <Separator Grid.Row="1" Background="#E0E0E0" Height="1"/>
      
      <!-- è¯¦æƒ…å’Œç§‘ç›®ç»„åŒºåŸŸ -->
  <Grid Grid.Row="2" ColumnDefinitions="3*,2*" ColumnSpacing="20">
        
        <!-- æ•™å¸ˆè¯¦æƒ… -->
  <Border Grid.Column="0" BorderBrush="#DDD" BorderThickness="1" CornerRadius="6" Padding="12" MinWidth="300">
          <Grid RowDefinitions="Auto,*" RowSpacing="12">
            <StackPanel Orientation="Horizontal" Spacing="8">
              <TextBlock Text="æ•™å¸ˆè¯¦æƒ…" FontWeight="Bold"/>
              <Button Content="ä¿å­˜" IsEnabled="{Binding IsTeacherSelected}" 
                      Click="OnSaveTeacherClick"/>
              <Button Content="åˆ é™¤" IsEnabled="{Binding IsTeacherSelected}" 
                      Click="OnDeleteTeacherClick"/>
            </StackPanel>
            
            <StackPanel Grid.Row="1" Spacing="10" IsEnabled="{Binding IsTeacherSelected}">
              <Grid ColumnDefinitions="80,*" RowDefinitions="Auto,Auto,Auto,Auto" RowSpacing="8" ColumnSpacing="10">
                <TextBlock Text="å§“å:" Grid.Row="0" VerticalAlignment="Center"/>
                <TextBox Grid.Column="1" Grid.Row="0" Text="{Binding SelectedTeacher.Name, Mode=TwoWay}"/>
                
                <TextBlock Text="ç§‘ç›®:" Grid.Row="1" VerticalAlignment="Center"/>
                <TextBox Grid.Column="1" Grid.Row="1" Text="{Binding SelectedTeacher.Subject, Mode=TwoWay}"/>
                
                <TextBlock Text="ç§‘ç›®ç»„:" Grid.Row="2" VerticalAlignment="Center"/>
                <ComboBox Grid.Column="1" Grid.Row="2"
                          ItemsSource="{Binding SubjectGroupNames}"
                          SelectedItem="{Binding SelectedTeacher.SubjectGroup, Mode=TwoWay}"/>
                
                <TextBlock Text="ç­çº§:" Grid.Row="3" VerticalAlignment="Top" Margin="0,4,0,0"/>
                <TextBox Grid.Column="1" Grid.Row="3" 
                         Text="{Binding ClassesText, Mode=TwoWay}" 
                         Watermark="ç”¨åˆ†å·åˆ†éš”ï¼Œå¦‚ï¼šä¸€ç­;äºŒç­"
                         AcceptsReturn="True" TextWrapping="Wrap" MinHeight="60"/>
              </Grid>
            </StackPanel>
          </Grid>
        </Border>
        
        <!-- ç§‘ç›®ç»„ä¿¡æ¯ -->
        <Border Grid.Column="1" BorderBrush="#DDD" BorderThickness="1" CornerRadius="6" Padding="12" MinWidth="200">
          <Grid RowDefinitions="Auto,*" RowSpacing="8">
            <TextBlock Text="ç§‘ç›®ç»„" FontWeight="Bold"/>
            <ItemsControl Grid.Row="1" ItemsSource="{Binding SubjectGroups}">
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <Border BorderBrush="#EEE" BorderThickness="0,0,0,1" Padding="6" Margin="0,2">
                    <StackPanel Spacing="2">
                      <TextBlock Text="{Binding Name}" FontWeight="SemiBold" FontSize="13"/>
                      <TextBlock Text="{Binding Description}" FontSize="11" Foreground="Gray"/>
                    </StackPanel>
                  </Border>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
          </Grid>
        </Border>
        
      </Grid>
    </Grid>
    </ScrollViewer>
    
    <!-- çŠ¶æ€æ  -->
    <TextBlock Grid.Row="4" Text="{Binding StatusMessage}" Foreground="Gray" FontSize="12"/>
    
  </Grid>
</UserControl>
