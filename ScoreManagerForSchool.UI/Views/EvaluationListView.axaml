<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:ScoreManagerForSchool.UI.ViewModels"
             xmlns:core="using:ScoreManagerForSchool.Core.Storage"
             x:Class="ScoreManagerForSchool.UI.Views.EvaluationListView"
             x:DataType="vm:EvaluationListViewModel"
             x:Name="Root">

  <ScrollViewer>
    <Border Padding="12">
    <StackPanel Spacing="12">
      <TextBlock Text="ç§¯åˆ†è®°å½•ç®¡ç†" 
                FontSize="20" 
                FontWeight="Bold" 
                Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>

      <StackPanel Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
        <TextBox Width="300" 
                Watermark="æœç´¢ (å§“å/å­¦å·/ç­çº§/å¤‡æ³¨/æ•™å¸ˆ)" 
                Text="{Binding Query, Mode=TwoWay}"
                Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
                BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                CornerRadius="6"/>
        <Button Content="åˆ·æ–°" 
               Command="{Binding RefreshCommand}"
               Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
               Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
               BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
               CornerRadius="6"
               Padding="12,6">
          <Button.Styles>
            <Style Selector="Button:pointerover">
              <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumLowBrush}"/>
              <Setter Property="BorderBrush" Value="{DynamicResource SystemControlForegroundAccentBrush}"/>
            </Style>
            <Style Selector="Button:pressed">
              <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumBrush}"/>
            </Style>
          </Button.Styles>
        </Button>
        <Button Content="æ·»åŠ è®°å½•" 
               Command="{Binding AddCommand}"
               Background="{DynamicResource SystemControlAccentBrush}"
               Foreground="{DynamicResource SystemControlForegroundChromeWhiteBrush}"
               BorderBrush="{DynamicResource SystemControlAccentBrush}"
               CornerRadius="6"
               Padding="12,6">
          <Button.Styles>
            <Style Selector="Button:pointerover">
              <Setter Property="Background" Value="{DynamicResource SystemControlAccentDark1Brush}"/>
              <Setter Property="BorderBrush" Value="{DynamicResource SystemControlAccentDark1Brush}"/>
            </Style>
            <Style Selector="Button:pressed">
              <Setter Property="Background" Value="{DynamicResource SystemControlAccentDark2Brush}"/>
            </Style>
          </Button.Styles>
        </Button>
      </StackPanel>

      <!-- ç­›é€‰æ¡ä»¶é¢æ¿ - ä¸»é¢˜é€‚é…ç‰ˆæœ¬ -->
      <Border BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}" 
              BorderThickness="1" 
              CornerRadius="8" 
              Padding="12" 
              Background="{DynamicResource SystemControlBackgroundAltHighBrush}">
        <StackPanel Spacing="12">
          <TextBlock Text="ç­›é€‰æ¡ä»¶" 
                    FontWeight="SemiBold" 
                    FontSize="16" 
                    Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
          <StackPanel Orientation="Horizontal" Spacing="16" VerticalAlignment="Center">
            <StackPanel Orientation="Horizontal" Spacing="6">
              <TextBlock Text="ç­çº§:" 
                        VerticalAlignment="Center" 
                        MinWidth="90" 
                        Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
              <ComboBox Width="120" 
                       ItemsSource="{Binding ClassOptions}" 
                       SelectedItem="{Binding SelectedClass, Mode=TwoWay}"
                       Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                       Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
                       BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                       CornerRadius="6"/>
            </StackPanel>
            
            <!-- æ—¥æœŸé€‰æ‹©åŒºåŸŸ - ç§»é™¤è¾¹æ¡† -->
            <StackPanel Orientation="Horizontal" Spacing="16">
              <!-- å¼€å§‹æ—¥æœŸ -->
              <StackPanel Orientation="Horizontal" Spacing="6">
                <TextBlock Text="ðŸ“…" 
                          VerticalAlignment="Center" 
                          FontSize="16" 
                          Foreground="{DynamicResource SystemControlForegroundAccentBrush}"/>
                <TextBlock Text="å¼€å§‹:" 
                          VerticalAlignment="Center" 
                          FontWeight="Medium" 
                          Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                <Button Name="StartDateButton" 
                        Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                        Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
                        BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                        BorderThickness="1"
                        CornerRadius="6"
                        Padding="12,6"
                        Width="140"
                        HorizontalContentAlignment="Center"
                        Click="OnStartDateButtonClick">
                  <TextBlock Text="{Binding StartDate, StringFormat={}{0:yyyy-MM-dd}, TargetNullValue=é€‰æ‹©æ—¥æœŸ}"/>
                  <Button.Styles>
                    <Style Selector="Button:pointerover">
                      <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumLowBrush}"/>
                      <Setter Property="BorderBrush" Value="{DynamicResource SystemControlForegroundAccentBrush}"/>
                    </Style>
                    <Style Selector="Button:pressed">
                      <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumBrush}"/>
                    </Style>
                  </Button.Styles>
                </Button>
                  <Popup Name="StartDatePopup" 
                         IsLightDismissEnabled="True" 
                         PlacementTarget="{Binding ElementName=StartDateButton}"
                         Placement="Bottom"
                         HorizontalOffset="-10"
                         VerticalOffset="4">
                    <Border Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" 
                            BorderBrush="{DynamicResource SystemControlForegroundBaseMediumBrush}" 
                            BorderThickness="1" 
                            CornerRadius="8"
                            Padding="16">
                      <Border.Effect>
                        <DropShadowEffect OffsetX="0" OffsetY="4" BlurRadius="16" Opacity="0.25"/>
                      </Border.Effect>
                      <Calendar Name="StartDateCalendar" 
                                Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
                                Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}">
                        <Calendar.Styles>
                          <!-- æ—¥æœŸæŒ‰é’®æ ·å¼ -->
                          <Style Selector="CalendarDayButton">
                            <Setter Property="FontSize" Value="11"/>
                            <!-- é€šè¿‡å¤§åœ†è§’å®žçŽ°åœ†å½¢å¤–è§‚ï¼Œä½†ä¸ä¿®æ”¹å°ºå¯¸ -->
                            <Setter Property="CornerRadius" Value="999"/>
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                          </Style>
                          
                          <!-- æ‚¬æµ®æ•ˆæžœ -->
                          <Style Selector="CalendarDayButton:pointerover">
                            <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundListMediumBrush}"/>
                            <!-- ä½¿ç”¨ç»†æè¾¹è¥é€ åœ†å½¢é˜´å½±çš„è§†è§‰ï¼Œä¸æ”¹å˜å¤§å° -->
                            <Setter Property="BorderBrush" Value="{DynamicResource SystemControlForegroundAccentBrush}"/>
                            <Setter Property="BorderThickness" Value="1"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                          </Style>
                          
                          <!-- é€‰ä¸­çŠ¶æ€ -->
                          <Style Selector="CalendarDayButton:selected">
                            <Setter Property="Background" Value="{DynamicResource SystemControlAccentBrush}"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundChromeWhiteBrush}"/>
                          </Style>
                          
                          <!-- é€‰ä¸­+æ‚¬æµ®çŠ¶æ€ -->
                          <Style Selector="CalendarDayButton:selected:pointerover">
                            <Setter Property="Background" Value="{DynamicResource SystemControlAccentDark1Brush}"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundChromeWhiteBrush}"/>
                          </Style>
                          
                          <!-- ä»Šå¤©çš„ç‰¹æ®Šæ ·å¼ -->
                          <Style Selector="CalendarDayButton:today">
                            <Setter Property="BorderBrush" Value="{DynamicResource SystemControlAccentBrush}"/>
                            <Setter Property="BorderThickness" Value="1"/>
                          </Style>
                          
                          <!-- æœˆä»½/å¹´ä»½æ ‡é¢˜æ ·å¼ -->
                          <Style Selector="CalendarButton">
                            <Setter Property="FontSize" Value="12"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="CornerRadius" Value="4"/>
                            <Setter Property="Padding" Value="6,3"/>
                          </Style>
                          
                          <Style Selector="CalendarButton:pointerover">
                            <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundListMediumBrush}"/>
                          </Style>
                          
                          <!-- å¯¼èˆªæŒ‰é’®æ ·å¼ -->
                          <Style Selector="RepeatButton">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                          </Style>
                          
                          <Style Selector="RepeatButton:pointerover">
                            <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundListMediumBrush}"/>
                          </Style>
                        </Calendar.Styles>
                      </Calendar>
                    </Border>
                  </Popup>
                </StackPanel>
                
                <Rectangle Width="1" 
                          Height="24" 
                          Fill="{DynamicResource SystemControlForegroundBaseMediumLowBrush}" 
                          VerticalAlignment="Center"/>
                
                <!-- ç»“æŸæ—¥æœŸ -->
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <TextBlock Text="ðŸ“…" 
                            VerticalAlignment="Center" 
                            FontSize="16" 
                            Foreground="{DynamicResource SystemControlForegroundAccentBrush}"/>
                  <TextBlock Text="ç»“æŸ:" 
                            VerticalAlignment="Center" 
                            FontWeight="Medium" 
                            Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                  <Button Name="EndDateButton" 
                          Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                          Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
                          BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                          BorderThickness="1"
                          CornerRadius="6"
                          Padding="12,6"
                          Width="140"
                          HorizontalContentAlignment="Center"
                          Click="OnEndDateButtonClick">
                    <TextBlock Text="{Binding EndDate, StringFormat={}{0:yyyy-MM-dd}, TargetNullValue=é€‰æ‹©æ—¥æœŸ}"/>
                    <Button.Styles>
                      <Style Selector="Button:pointerover">
                        <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumLowBrush}"/>
                        <Setter Property="BorderBrush" Value="{DynamicResource SystemControlForegroundAccentBrush}"/>
                      </Style>
                      <Style Selector="Button:pressed">
                        <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumBrush}"/>
                      </Style>
                    </Button.Styles>
                  </Button>
                  <Popup Name="EndDatePopup" 
                         IsLightDismissEnabled="True" 
                         PlacementTarget="{Binding ElementName=EndDateButton}"
                         Placement="Bottom"
                         HorizontalOffset="-10"
                         VerticalOffset="4">
                    <Border Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" 
                            BorderBrush="{DynamicResource SystemControlForegroundBaseMediumBrush}" 
                            BorderThickness="1" 
                            CornerRadius="8"
                            Padding="16">
                      <Border.Effect>
                        <DropShadowEffect OffsetX="0" OffsetY="4" BlurRadius="16" Opacity="0.25"/>
                      </Border.Effect>
                      <Calendar Name="EndDateCalendar" 
                                Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
                                Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}">
                        <Calendar.Styles>
                          <!-- æ—¥æœŸæŒ‰é’®æ ·å¼ -->
                          <Style Selector="CalendarDayButton">
                            <Setter Property="FontSize" Value="11"/>
                            <Setter Property="CornerRadius" Value="999"/>
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                          </Style>
                          
                          <!-- æ‚¬æµ®æ•ˆæžœ -->
                          <Style Selector="CalendarDayButton:pointerover">
                            <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundListMediumBrush}"/>
                            <Setter Property="BorderBrush" Value="{DynamicResource SystemControlForegroundAccentBrush}"/>
                            <Setter Property="BorderThickness" Value="1"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                          </Style>
                          
                          <!-- é€‰ä¸­çŠ¶æ€ -->
                          <Style Selector="CalendarDayButton:selected">
                            <Setter Property="Background" Value="{DynamicResource SystemControlAccentBrush}"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundChromeWhiteBrush}"/>
                          </Style>
                          
                          <!-- é€‰ä¸­+æ‚¬æµ®çŠ¶æ€ -->
                          <Style Selector="CalendarDayButton:selected:pointerover">
                            <Setter Property="Background" Value="{DynamicResource SystemControlAccentDark1Brush}"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundChromeWhiteBrush}"/>
                          </Style>
                          
                          <!-- ä»Šå¤©çš„ç‰¹æ®Šæ ·å¼ -->
                          <Style Selector="CalendarDayButton:today">
                            <Setter Property="BorderBrush" Value="{DynamicResource SystemControlAccentBrush}"/>
                            <Setter Property="BorderThickness" Value="1"/>
                          </Style>
                          
                          <!-- æœˆä»½/å¹´ä»½æ ‡é¢˜æ ·å¼ -->
                          <Style Selector="CalendarButton">
                            <Setter Property="FontSize" Value="12"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="CornerRadius" Value="4"/>
                            <Setter Property="Padding" Value="6,3"/>
                          </Style>
                          
                          <Style Selector="CalendarButton:pointerover">
                            <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundListMediumBrush}"/>
                          </Style>
                          
                          <!-- å¯¼èˆªæŒ‰é’®æ ·å¼ -->
                          <Style Selector="RepeatButton">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                          </Style>
                          
                          <Style Selector="RepeatButton:pointerover">
                            <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundListMediumBrush}"/>
                          </Style>
                        </Calendar.Styles>
                      </Calendar>
                    </Border>
                  </Popup>
                </StackPanel>
              </StackPanel>
            
            <CheckBox Content="ä»…æ˜¾ç¤ºæ‰£åˆ†è®°å½•" 
                     IsChecked="{Binding ShowNegativeScoresOnly, Mode=TwoWay}"
                     Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
                     Margin="0,8,0,0"/>
          </StackPanel>
          <!-- æ—¶é—´å¿«æ·é€‰æ‹© -->
          <StackPanel Orientation="Horizontal" Spacing="12">
            <TextBlock Text="å¿«æ·æ—¶é—´:" 
                      VerticalAlignment="Center" 
                      FontWeight="Medium" 
                      Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
            <Button Content="ä»Šå¤©" 
                   Click="OnSetToday" 
                   Padding="10,4"
                   Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                   Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
                   BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                   CornerRadius="4"
                   FontSize="12">
              <Button.Styles>
                <Style Selector="Button:pointerover">
                  <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumLowBrush}"/>
                </Style>
              </Button.Styles>
            </Button>
            <Button Content="æ˜¨å¤©" 
                   Click="OnSetYesterday" 
                   Padding="10,4"
                   Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                   Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
                   BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                   CornerRadius="4"
                   FontSize="12">
              <Button.Styles>
                <Style Selector="Button:pointerover">
                  <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumLowBrush}"/>
                </Style>
              </Button.Styles>
            </Button>
            <Button Content="æœ¬å‘¨" 
                   Click="OnSetThisWeek" 
                   Padding="10,4"
                   Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                   Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
                   BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                   CornerRadius="4"
                   FontSize="12">
              <Button.Styles>
                <Style Selector="Button:pointerover">
                  <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumLowBrush}"/>
                </Style>
              </Button.Styles>
            </Button>
            <Button Content="æœ¬æœˆ" 
                   Click="OnSetThisMonth" 
                   Padding="10,4"
                   Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                   Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
                   BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                   CornerRadius="4"
                   FontSize="12">
              <Button.Styles>
                <Style Selector="Button:pointerover">
                  <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumLowBrush}"/>
                </Style>
              </Button.Styles>
            </Button>
            <Button Content="æ¸…é™¤æ—¶é—´" 
                   Click="OnClearDates" 
                   Padding="10,4"
                   Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                   Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"
                   BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                   CornerRadius="4"
                   FontSize="12">
              <Button.Styles>
                <Style Selector="Button:pointerover">
                  <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumLowBrush}"/>
                </Style>
              </Button.Styles>
            </Button>
          </StackPanel>
        </StackPanel>
      </Border>

      <Grid ColumnDefinitions="220,100,120,*,80,100,100,Auto" 
            Margin="0,4" 
            Background="{DynamicResource SystemControlBackgroundAltMediumBrush}"
            Height="32">
        <TextBlock Grid.Column="0" 
                  Text="æ—¥æœŸ" 
                  FontWeight="SemiBold" 
                  VerticalAlignment="Center" 
                  Margin="8,0"
                  Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
        <TextBlock Grid.Column="1" 
                  Text="ç­çº§" 
                  FontWeight="SemiBold" 
                  VerticalAlignment="Center" 
                  Margin="8,0"
                  Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
        <TextBlock Grid.Column="2" 
                  Text="å­¦å·" 
                  FontWeight="SemiBold" 
                  VerticalAlignment="Center" 
                  Margin="8,0"
                  Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
        <TextBlock Grid.Column="3" 
                  Text="å§“å" 
                  FontWeight="SemiBold" 
                  VerticalAlignment="Center" 
                  Margin="8,0"
                  Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
        <TextBlock Grid.Column="4" 
                  Text="ç§¯åˆ†" 
                  FontWeight="SemiBold" 
                  VerticalAlignment="Center" 
                  Margin="8,0"
                  Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
        <TextBlock Grid.Column="5" 
                  Text="æ•™å¸ˆ" 
                  FontWeight="SemiBold" 
                  VerticalAlignment="Center" 
                  Margin="8,0"
                  Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
        <TextBlock Grid.Column="6" 
                  Text="å¤‡æ³¨" 
                  FontWeight="SemiBold" 
                  VerticalAlignment="Center" 
                  Margin="8,0"
                  Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
        <TextBlock Grid.Column="7" 
                  Text="æ“ä½œ" 
                  FontWeight="SemiBold" 
                  VerticalAlignment="Center" 
                  Margin="8,0"
                  Foreground="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
      </Grid>
      
      <ListBox ItemsSource="{Binding Evaluations}" 
               SelectedItem="{Binding SelectedEvaluation, Mode=TwoWay}" 
               Height="400"
               Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
               BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
               BorderThickness="1"
               CornerRadius="6">
        <ListBox.Styles>
          <Style Selector="ListBoxItem">
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Padding" Value="4"/>
            <Setter Property="CornerRadius" Value="4"/>
          </Style>
          <Style Selector="ListBoxItem:selected">
            <Setter Property="Background" Value="{DynamicResource SystemControlHighlightListAccentMediumBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundChromeWhiteBrush}"/>
          </Style>
          <Style Selector="ListBoxItem:pointerover">
            <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundListMediumBrush}"/>
          </Style>
        </ListBox.Styles>
        <ListBox.ItemTemplate>
          <DataTemplate x:DataType="core:EvaluationEntry">
            <Grid ColumnDefinitions="220,100,120,*,80,100,100,Auto" Margin="0,2">
              <Grid.Styles>
                <Style Selector="TextBox">
                  <Setter Property="MinWidth" Value="80"/>
                  <Setter Property="FontSize" Value="12"/>
                  <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseLowBrush}"/>
                  <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                  <Setter Property="BorderBrush" Value="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"/>
                  <Setter Property="CornerRadius" Value="4"/>
                  <Setter Property="Padding" Value="6,3"/>
                </Style>
                <Style Selector="TextBox:focus">
                  <Setter Property="BorderBrush" Value="{DynamicResource SystemControlForegroundAccentBrush}"/>
                  <Setter Property="BorderThickness" Value="2"/>
                </Style>
                <Style Selector="TextBlock">
                  <Setter Property="FontSize" Value="12"/>
                  <Setter Property="VerticalAlignment" Value="Center"/>
                  <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                  <Setter Property="Margin" Value="4,0"/>
                </Style>
                <Style Selector="Button">
                  <Setter Property="FontSize" Value="11"/>
                  <Setter Property="Padding" Value="8,3"/>
                  <Setter Property="CornerRadius" Value="4"/>
                  <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseLowBrush}"/>
                  <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundBaseHighBrush}"/>
                  <Setter Property="BorderBrush" Value="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"/>
                </Style>
                <Style Selector="Button:pointerover">
                  <Setter Property="Background" Value="{DynamicResource SystemControlBackgroundBaseMediumLowBrush}"/>
                </Style>
                <Style Selector="Button.delete-button">
                  <Setter Property="Background" Value="{DynamicResource SystemControlErrorTextBrush}"/>
                  <Setter Property="Foreground" Value="{DynamicResource SystemControlForegroundChromeWhiteBrush}"/>
                  <Setter Property="BorderBrush" Value="{DynamicResource SystemControlErrorTextBrush}"/>
                </Style>
                <Style Selector="Button.delete-button:pointerover">
                  <Setter Property="Background" Value="{DynamicResource SystemControlErrorTextBrush}"/>
                  <Setter Property="Opacity" Value="0.8"/>
                </Style>
              </Grid.Styles>
              
              <!-- éžç¼–è¾‘æ¨¡å¼ -->
              <TextBlock Grid.Column="0" Text="{Binding Date, StringFormat=M/d HH:mm}">
                <TextBlock.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}" ConverterParameter="Not">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBlock.IsVisible>
              </TextBlock>
              <TextBlock Grid.Column="1" Text="{Binding Class}">
                <TextBlock.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}" ConverterParameter="Not">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBlock.IsVisible>
              </TextBlock>
              <TextBlock Grid.Column="2" Text="{Binding StudentId}">
                <TextBlock.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}" ConverterParameter="Not">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBlock.IsVisible>
              </TextBlock>
              <TextBlock Grid.Column="3" Text="{Binding Name}">
                <TextBlock.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}" ConverterParameter="Not">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBlock.IsVisible>
              </TextBlock>
              <TextBlock Grid.Column="4" Text="{Binding Score}">
                <TextBlock.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}" ConverterParameter="Not">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBlock.IsVisible>
              </TextBlock>
              <TextBlock Grid.Column="5" Text="{Binding TeacherName}">
                <TextBlock.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}" ConverterParameter="Not">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBlock.IsVisible>
              </TextBlock>
              <TextBlock Grid.Column="6" Text="{Binding Remark}" TextTrimming="CharacterEllipsis" MaxWidth="150">
                <TextBlock.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}" ConverterParameter="Not">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBlock.IsVisible>
              </TextBlock>

              <!-- ç¼–è¾‘æ¨¡å¼ - ä¸»é¢˜é€‚é…ç‰ˆæœ¬ -->
              <!-- æ—¥æœŸä¸å¯ç¼–è¾‘ï¼Œæ˜¾ç¤ºä¸ºåªè¯»æ–‡æœ¬ -->
              <Border Grid.Column="0" 
                      Background="{DynamicResource SystemControlBackgroundBaseMediumLowBrush}"
                      CornerRadius="6"
                      Padding="8,4"
                      ToolTip.Tip="æ—¥æœŸä¸å¯æ›´æ”¹">
                <Border.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </Border.IsVisible>
                <TextBlock Text="{Binding Date, StringFormat=M/d HH:mm}" 
                          FontSize="12"
                          Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"
                          VerticalAlignment="Center"/>
              </Border>
              <TextBox Grid.Column="1" Text="{Binding Class, Mode=TwoWay}">
                <TextBox.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBox.IsVisible>
              </TextBox>
              <TextBox Grid.Column="2" Text="{Binding StudentId, Mode=TwoWay}">
                <TextBox.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBox.IsVisible>
              </TextBox>
              <TextBox Grid.Column="3" Text="{Binding Name, Mode=TwoWay}">
                <TextBox.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBox.IsVisible>
              </TextBox>
              <TextBox Grid.Column="4" Text="{Binding Score, Mode=TwoWay}">
                <TextBox.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBox.IsVisible>
              </TextBox>
              <TextBox Grid.Column="5" Text="{Binding TeacherName, Mode=TwoWay}">
                <TextBox.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBox.IsVisible>
              </TextBox>
              <TextBox Grid.Column="6" Text="{Binding Remark, Mode=TwoWay}">
                <TextBox.IsVisible>
                  <MultiBinding Converter="{StaticResource EqualsConverter}">
                    <Binding Path="#Root.DataContext.EditingId"/>
                    <Binding Path="Id"/>
                  </MultiBinding>
                </TextBox.IsVisible>
              </TextBox>

              <!-- æ“ä½œæŒ‰é’® -->
              <StackPanel Grid.Column="7" Orientation="Horizontal" Spacing="4">
                <!-- éžç¼–è¾‘çŠ¶æ€çš„æŒ‰é’® -->
                <Button Content="âœŽ" FontSize="12" Padding="4,2" Command="{Binding #Root.DataContext.EditCommand}" CommandParameter="{Binding}">
                  <Button.IsVisible>
                    <MultiBinding Converter="{StaticResource EqualsConverter}" ConverterParameter="Not">
                      <Binding Path="#Root.DataContext.EditingId"/>
                      <Binding Path="Id"/>
                    </MultiBinding>
                  </Button.IsVisible>
                </Button>
                <Button Content="ðŸ—‘" 
                       FontSize="12" 
                       Padding="4,2" 
                       Classes="delete-button"
                       Command="{Binding #Root.DataContext.DeleteCommand}" 
                       CommandParameter="{Binding}">
                  <Button.IsVisible>
                    <MultiBinding Converter="{StaticResource EqualsConverter}" ConverterParameter="Not">
                      <Binding Path="#Root.DataContext.EditingId"/>
                      <Binding Path="Id"/>
                    </MultiBinding>
                  </Button.IsVisible>
                </Button>
                
                <!-- ç¼–è¾‘çŠ¶æ€çš„æŒ‰é’® -->
                <Button Content="âœ“" FontSize="12" Padding="4,2" Command="{Binding #Root.DataContext.SaveCommand}" CommandParameter="{Binding}">
                  <Button.IsVisible>
                    <MultiBinding Converter="{StaticResource EqualsConverter}">
                      <Binding Path="#Root.DataContext.EditingId"/>
                      <Binding Path="Id"/>
                    </MultiBinding>
                  </Button.IsVisible>
                </Button>
                <Button Content="âœ—" FontSize="12" Padding="4,2" Command="{Binding #Root.DataContext.CancelCommand}">
                  <Button.IsVisible>
                    <MultiBinding Converter="{StaticResource EqualsConverter}">
                      <Binding Path="#Root.DataContext.EditingId"/>
                      <Binding Path="Id"/>
                    </MultiBinding>
                  </Button.IsVisible>
                </Button>
              </StackPanel>
            </Grid>
          </DataTemplate>
        </ListBox.ItemTemplate>
      </ListBox>
    </StackPanel>
    </Border>
  </ScrollViewer>
</UserControl>
