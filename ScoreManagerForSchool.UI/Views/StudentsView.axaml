<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:ScoreManagerForSchool.UI.ViewModels"
             xmlns:core="using:ScoreManagerForSchool.Core.Storage"
             x:Class="ScoreManagerForSchool.UI.Views.StudentsView"
             x:DataType="vm:StudentsViewModel">

  <Border Padding="12">
    <StackPanel Spacing="8">
      <TextBlock Text="学生管理" FontSize="16" FontWeight="Bold"/>
      <StackPanel Orientation="Horizontal" Spacing="8">
        <Button Content="加载" Command="{Binding LoadCommand}"/>
        <TextBox Width="320" Name="CsvPathBox" Watermark="学生 CSV 路径 (示例: students.csv)"/>
        <Button Content="预览导入" Click="OnPreviewImport"/>
        <TextBox Width="240" Watermark="搜索 (姓名/学号/班级)" Text="{Binding Query, Mode=TwoWay}"/>
      </StackPanel>

  <ListBox ItemsSource="{Binding Students}" SelectedItem="{Binding SelectedStudent, Mode=TwoWay}" Height="360">
        <ListBox.ItemTemplate>
          <DataTemplate x:DataType="core:Student">
            <StackPanel Orientation="Horizontal" Spacing="12">
              <TextBox Text="{Binding Class, Mode=TwoWay}" Width="120"/>
              <TextBox Text="{Binding Id, Mode=TwoWay}" Width="120"/>
              <TextBox Text="{Binding Name, Mode=TwoWay}"/>
            </StackPanel>
          </DataTemplate>
        </ListBox.ItemTemplate>
      </ListBox>

        <!-- paging controls moved below the list -->
        <StackPanel Orientation="Horizontal" Spacing="8" Name="PagingPanel" HorizontalAlignment="Center">
          <Button Content="上一页" Command="{Binding PrevPageCommand}"/>
          <TextBlock Text="{Binding Page}" VerticalAlignment="Center" Margin="8,0"/>
          <Button Content="下一页" Command="{Binding NextPageCommand}"/>
          <TextBlock Text="/" VerticalAlignment="Center" Margin="8,0"/>
          <TextBlock Text="{Binding TotalPages}" VerticalAlignment="Center"/>
        </StackPanel>

        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
          <Button Content="删除所选" Command="{Binding DeleteCommand}" Margin="8,0"/>
          <Button Content="保存所选" Command="{Binding SaveEditCommand}"/>
        </StackPanel>
    </StackPanel>
  </Border>

</UserControl>

